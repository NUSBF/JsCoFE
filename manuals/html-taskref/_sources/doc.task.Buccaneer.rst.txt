=======================================
Automatic Model Building with Buccaneer
=======================================

Buccaneer is used for automated model building or rebuilding a molecular replacement model in electron density map using the likelihood-based density target approach. The approach is advantageous at resolutions 2.5Å and lower, but may be used at a higher resolutions just as well.

Buccaneer performs model building in 10 stages:

1. Find candidate C-alpha positions
    *Candidate C-alpha positions are located by searching the electron density*

2. Grow them into chain fragments
    *The candidate C-alphas or input chains (*fixed model*) are grown by adding residues at either end, as suggested by the density*

3. Join and merge the fragments, resolving branches
    *Overlapping fragments are joined to make longer chains. If this leads to a junction in a chain, the contested residue is removed*

4. Link nearby N and C terminii (if possible)
    *Nearby N and C termini are examined to see if they can be linked by a short loop*

5. Sequence the chains (i.e. dock sequence)
    *Likelihood comparison between the density of each residue in the work structure and the residues of the reference structure (*model to aid sequencing*) allows sequence to be assigned to longer fragments*

6. Correct insertions/deletions
    *Insertions and deletions in the model building are fixed by rebuilding, where possible*

7. Filter based on poor density
    *Residues in poor density are removed*

8. NCS Rebuild to complete NCS copies of chains
    *Any NCS relationships found in the model are used to augment the related chains*

9. Prune any remaining clashing chains
    *Clashing fragments are examined and the one with the worse density is removed*

10. Rebuild side chains
     *Rebuilding allows side chain atoms and carbonyl oxygens to be rebuilt*
    

Buccaneer can build structures using phases obtained through both *Molecular Replacement* and *Experimental phasing*, using the corresponding intrinsic modes. In CCP4 Cloud, the phasing type is recognised automatically, and Buccaneer is put into appropriate mode without additional actions from user side.


**Molecular replacement mode**


In this mode, Buccaneer requires atomic model used for *Molecular Replacement*. The model is used for placing and naming chans, with the following additional options:

* **nothing else**:  MR model is not used for anything else. 

    This minimizes the possibility of bias, at the expense of slower building and often a less complete model. 
 
* **seed chain growing**: isolated residues from the model are used as starting points for growing a new model. 

    This usually produces a fairly complete model without significant bias, and should be used in most cases.

* **provide an initial model**: most of the model is used as a set of initial fragments for building. 

    This may be useful when the initial map is too poor for reliable building, but the resulting model is more biased towards the molecular replacement model.

You may also provide the **Fixed model** containing an initial model to extend. Note that this model should be correctly positioned in electron density.

In addition, you may supply the **Model to aid sequencing**, which is a model with known residues to help the residue type assignment.


``The following options and parameters are applicable for both “Molecular Replacement” and “Experimental phasing” Buccaneer`s modes``

-------
Options
-------

**Anisotropy correction** attempts to remove directional dependence in diffraction data. **This should use by default**

**Build Selenomethionine (MSE istead of MET)** option should be chosen if selenomethionine is present.

**Number of building/refinement cycles** may be set more than 5(default number) if first attempt ends up with an incomplete model. 

.. Note::
    The chance to benefit from using more than 20 cycles is really small

**Use fastest methods** option shortens the job running time without a loss in quality of obtained results in most cases. In case of low resolution data, turning this option off may produce better results.

--------------------------
Model Building Parameters
--------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++++
Parameters for first and subsequent Buccaneer cycles
++++++++++++++++++++++++++++++++++++++++++++++++++++

**Number of internal building cycles**. By default, Buccaneer performs 3 cycles for the "first Buccaneer cycle" and 2 cycles for all "subsequent Buccaneer cycles" of finding, growing and sequencing protein chains. It can be increased to 50 if the default number of cycles is not sufficient for completing the final model.

**Use the correlation target function** for growing new chains and sequencing. This function uses the likelihood target for identifying protein features, which is less efficient at the initial building steps but works better for model completion.

**Assign sequence when found match is**: **probable** is used by default, which corresponds to the situation when sequences are docked if the match to electron density is estimated as reasonably good. This can be changed to **definite**, causing sequence docking to occur only in case of fairly good matches, or to **possible** for performing sequence docking at virtually any plausible match.

------------------
General parameters
------------------

**Truncate data beyond resolution limit [Å]**. Using high resolution data in Buccaneer makes it slower and more memory-consuming, yet it does not contribute significantly to the quality of the final model. Therefore, by default, reflection data is truncated beyond 2.0Å, unless you change this value.

**Residue name for unsequenced residues** you may set the name which will be given to newly built residues of unrecognised type. The default is 'UNK', change this to 'ALA' if you need to use the built model in a program which doesn't recognise 'UNK' (this should not be required in CCP4 Cloud).

-------------------
Reference structure
-------------------

Reference structure is used for generating search target functions of various structural features to be identified in electron density map. Any reasonable-quality PDB structure with sufficient structural diversity and available reflection data may be taken as a reference.

**Library reference structure to use** option allows you to change the buccaneer reference structure; ``1tqw`` is used by default and hardly needs changing. 

Further refinement is performed by Refmac, read more about :doc:`Refmac Parameters <doc.task.Refmac>`

Read more about Buccaneer `here <http://www.ysbl.york.ac.uk/~cowtan/buccaneer/buccaneer.html>`_

**REFERENCES**

`Cowtan, K. (2006) The Buccaneer software for automated model building. Acta Cryst. D62: 1002-1011 <https://journals.iucr.org/d/issues/2006/09/00/av5064/>`_

`Cowtan K. (2010). Recent developments in classical density modification. Acta crystallographica. Section D, Biological crystallography, 66(Pt 4), 470–478 <https://doi.org/10.1107/S090744490903947X>`_

`Cowtan, K. (2012) Completion of autobuilt protein models using a database of protein fragments. Acta Cryst. D68: 328-335 <https://journals.iucr.org/d/issues/2012/04/00/ba5169/index.html>`_


