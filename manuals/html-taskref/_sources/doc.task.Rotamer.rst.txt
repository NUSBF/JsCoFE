=======
ROTAMER
=======


This program reads a protein coordinate file in PDB format and lists all amino acids whose side chain torsion angles deviate more than a user-defined threshold from the `rotamers <https://www.ccp4.ac.uk/html/rotamer_table.html>`_ of the `Penultimate Rotamer Library <http://www2.denizyuret.com/ref/lovell/ref5.pdf>`_ 

An amino acid is listed if at least one side chain torsion angle deviates more than a user-defined threshold ``delt``  from the equivalent one of the nearest rotamer. An amino acid is listed if at least one side chain torsion angle deviates more than a user-defined threshold DELT  from the equivalent one of the nearest rotamer. Empirically, the following two-step procedure to find the nearest rotamer seems to work quite reasonably, producing only a few false negatives or false positives: The first step is to choose a subset of potential nearest rotamers in a hierarchical order going from the first side chain torsion angle Chi(1) to the last side chain torsion angle Chi(n). For a side chain with four Chi-angles, first, all rotamers deviating less than the user-defined threshold in Chi(1) are chosen, then of those all rotamers that deviate less in Chi(2) are chosen, then of those all rotamers that deviate less in Chi(3) are chosen, and finally of those all rotamers that deviate less in Chi(4) are chosen. If a subset for Chi(i) is empty, the subset for the previous Chi(i-1) is chosen and the hierarchical search is terminated. If the subset for Chi(1) is empty, simply all rotamers are chosen as a “subset”. The second step is to find the nearest rotamer out of the previously chosen subset of rotamers. Here, the nearest rotamer is the one with the minimum sum over the absolute Delta-Chi(i) values.

To list all amino acids with at least one side chain **torsion angle** deviating more than **40°** from its nearest rotamer type ``delt 40``

.. note::
        The task uses XYZ data from the chosen input object and does not create any output data objects. All output is found in the *Main Log* tab and may be downloaded as a text file using 
        the *Download* button provided in the main *Report* tab.

read more `here <https://www.ccp4.ac.uk/html/rotamer.html>`_

**References**

`Lovell, S.C., Word, J.M., Richardson, J.S. & Richardson, D.C. “The penultimate rotamer library”, Proteins: Structure, Function and Genetics, Vol.40, 389-408 (2000). <https://www.researchgate.net/publication/12456653_The_Penultimate_Rotamer_Library#:~:text=10.1002/1097%2D0134(20000815)40%3A3%3C389%3A%3AAID%2DPROT50%3E3.0.CO%3B2%2D2>`_


