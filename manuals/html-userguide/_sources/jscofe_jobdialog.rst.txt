==========
Job Dialog
==========

The Job Dialog is central to CCP4 Cloud functionality. It is used to configure a job (choose/set input data and parameters), run it, and review results. The Dialog opens automatically upon selecting a task in the **Task List** or pressing the |openjob| button in the **Project Page toolbar** (also accessible by right-clicking a job in the Job Tree).

.. |openjob| image:: images/openjob.png
   :width: 16
   :height: 16

--------------
General Layout
--------------

The dialog consists of two pages: **Input** and **Output**, along with a toolbar at the top:

.. image:: images/job_dialog_toolbar.png
   :scale: 50%
   :align: center

- **Input and Output Buttons**: Located on the left side of the toolbar, these switch between the **Input** and **Output** pages. (The **Output** button is disabled until results are available.)
- **Central Toolbar**: Displays:
  - The **Run button** to start the job.
  - A **busy indicator** and **Stop button** while the job is running.
  - The **job status** ("completed," "failed," or "terminated") after completion.
- **Ref. Button**: Displays reference documentation for the current task.
- **Help Button**: Opens this manual.
- **Close Button**: Closes the Dialog without running the job.

-----------
Input Page
-----------

The **Input** page is divided into three sections: **Header**, **Data Section**, and **Parameters Section**.

++++++++++
The Header
++++++++++

The Header displays the job title and includes two input fields: **Job Description** and **Output ID**.

.. image:: images/job_dialog_toolbar.png
   :scale: 50%
   :align: center

Both fields have default values that are suitable in many cases but can be customized as needed:

===================     ================================================================================================================================================================================================================================================
**Job Description**     Provides a brief description for display in the Job Tree. Use this field to annotate your project (e.g., "2nd molecular replacement attempt using sequence correction of the model"). This field can be edited before and after running the job.

**Output ID**           Specifies a template name for output data. Refer to the "Naming" section in Data Management. Customizing this field helps generate and download output files with meaningful names.
===================     ================================================================================================================================================================================================================================================

++++++++++++
Data Section
++++++++++++

The Data Section contains widgets (e.g., comboboxes) for selecting required data objects for the job. Each data type required by the job is represented by its own combobox. For example:

.. image:: images/job_dialog_data_section_1.png
   :scale: 40%
   :align: center

This example shows:
- One **Structure Revision**.
- One or more **anomalous HKL Datasets**.
- One **native HKL Dataset**.

Combobox selections are pre-set based on the task and project logic. Users should verify the selections in all cases.

- If additional input is required, another combobox (e.g., *"Anomalous reflection data (3)"*) will appear with the default value `[do not use]`. Selecting a dataset in this combobox passes it as another input.

Some comboboxes include supplementary input widgets for annotating selected data objects. For example:
- Anomalous datasets may require wavelength annotations (*"low-remote"*, *"peak"*, etc.).
- Native datasets may include a checkbox to indicate their use for phasing in addition to model building and refinement.

Inspection buttons next to comboboxes allow detailed viewing of selected data, including space group, cell parameters, and chain descriptions. Optional data widgets will not appear if corresponding data is unavailable in the project.

++++++++++++++++++
Parameters Section
++++++++++++++++++

The Parameters Section contains task-specific parameters, organized into collapsible sections:

.. image:: images/job_dialog_parameters_section__1_.png
   :scale: 40%
   :align: center

Parameters may be hidden dynamically based on user selections in the **Data Section** or other parts of the **Parameters Section**.

+++++++++++
Output Page
+++++++++++

The **Output** page presents job results in a tabbed layout. Common tabs include **"Report"**, **"Log File"**, and **"Errors"**, with additional tabs provided for certain tasks.

Output is dynamic and updates in real time as the job progresses. Tabs serve the following purposes:

- **"Log File"**: Displays the concatenated standard output of all programs executed during the job. Command lines and standard input data for each program are also shown.
- **"Errors"**: Displays standard error streams for debugging.
- **"Report"**: Typically includes:
   - Job title.
   - Report body with sections (collapsible for brevity).
   - Summary of generated data for subsequent tasks.

Example:

.. image:: images/job_dialog_output_page.png
   :scale: 40%
   :align: center

Reports often include detailed tables, graphs, and intermediate results. Generated 
data summaries appear after the report body, with inspection and visualization 
buttons for further exploration:

- **"Coot"**, **"CCP4mg"**, and **"UglyMol"**: Launch viewers for structural data.
- **"ViewHKL"**: Opens a utility to inspect MTZ file content.
- **"Display"**: Launches a viewer for inspecting XYZ files (e.g., in PDB format).

