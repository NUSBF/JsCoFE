
:orphan:

==============================
CCP4 Cloud AlphaFold Utilities
==============================

`AlphaFold2 <https://www.nature.com/articles/s41586-021-03819-2>`_ and `RosettaFold <https://robetta.bakerlab.org/>`_ predicted models are widely recognized as valuable structure templates for Molecular Replacement. This article outlines the integration of AlphaFold2 into CCP4 Cloud at various stages of the structure determination process.

.. include:: jscofe_tips.AlphaFold.rst
    :start-line: 4
    :end-line: 24

-----------------------------------
Generating or Importing Predicted Models
-----------------------------------

CCP4 Cloud not only supports the `import <../html-taskref/doc.task.Import.html>`__ of predicted models but also facilitates their generation for use in molecular replacement programs like `Phaser <../html-taskref/doc.task.Phaser.html>`_ and `Molrep <../html-taskref/doc.task.Molrep.html>`_.

To **generate models**, CCP4 Cloud provides the following tasks:

#. The `Structure Prediction <../html-taskref/doc.task.StructurePrediction.html>`_ task, which employs AlphaFold-2 to generate structure models from a given sequence.

    .. image:: images/structure_prediction_all_tasks.png
         :scale: 50 %
         :align: center

    After importing or generating a model, the `Prepare MR Model(s) from Coordinate Data <../html-taskref/doc.task.ModelPrepXYZ.html>`_ task prepares MR search models from the predicted structures.

#. The `Find and Prepare MR Models with MrParse <../html-taskref/doc.task.MrParse.html>`_ task identifies structural homologs suitable for creating MR search models from the PDB and the **AlphaFold2 Database**. Relevant structures are selected based on sequence alignment using `PHMMER <http://hmmer.org/>`_.

#. The `Prepare MR Ensemble with CCP4mg <../html-taskref/doc.task.EnsemblePrepMG.html>`_ task utilizes `MrBump <../html-taskref/doc.task.MrBump.html>`__ to construct an `MR Ensemble <../html-taskref/doc.task.Ensembler.html>`_ from structural homologs. This process involves alignment and truncation of homologous structures identified in the PDB and **AlphaFold2 Database** via sequence-based searches.

#. The `Prepare MR Ensemble from Sequence <../html-taskref/doc.task.EnsemblePrepSeq.html>`_ task uses `MrBump <../html-taskref/doc.task.MrBump.html>`__ to automatically prepare an `MR Ensemble <../html-taskref/doc.task.Ensembler.html>`_ from a target sequence. This task includes identifying suitable structural homologs in the PDB and, optionally, the **AlphaFold2 Database**, trimming them, and superimposing the best candidates.

-----------------------
Processing Predicted Models
-----------------------

Inaccuracies in domain-domain orientations can limit the effectiveness of predicted models for MR. The `Split MR Model with Slice-n-Dice <../html-taskref/doc.task.Slice.html>`_ task allows predicted models to be divided into distinct structural units, which can then be placed in an automated MR pipeline.

-------------------------------
Automated Molecular Replacement
-------------------------------

Automated Molecular Replacement pipelines **search for homologous structures in the PDB and AlphaFold Database**, **generate suitable search models** from the templates, **perform molecular replacement**, and **validate the solutions** with iterative rounds of restrained refinement.

The following Automated Molecular Replacement pipelines in CCP4 Cloud support AlphaFold Database searches:

#. `MrBump's <../html-taskref/doc.task.MrBump.html>`__ model search applies alignment and truncation procedures using homologous structures from the `PDB <https://www.rcsb.org/>`_ and `AlphaFold Database <https://doi.org/10.1038/s41586-021-03819-2>`_.

#. The `MR with Model Splitting Using Slice-n-Dice <../html-taskref/doc.task.SliceNDice.html>`_ task preprocesses `AlphaFold2 <https://www.nature.com/articles/s41586-021-03819-2>`_ and `RosettaFold <https://robetta.bakerlab.org/>`_ models by removing low-confidence regions and converting confidence scores into predicted B-factors. It can slice models into structural units using AlphaFold2's predicted aligned error (PAE) or clustering algorithms for broader applicability. **Slice-n-Dice addresses domain-domain orientation inaccuracies in predicted models.**

#. `Arcimboldo Shredder <../html-taskref/doc.task.ArcimboldoShredder.html>`_ automatically preprocesses AlphaFold or RoseTTAFold models by removing unstructured and disconnected regions and verifying MR solutions.

----------
Refinement
----------

Refinement optimizes the agreement between the model and X-ray data as the final step in macromolecular crystal structure determination. For low-resolution data (below 3 Ã…), it is essential to utilize all available macromolecular information. The `Low-Resolution Refinement with Lorestr <../html-taskref/doc.task.Lorestr.html>`_ task leverages the **AlphaFold2 Database** to identify homologs, enabling Lorestr to determine optimal refinement parameters.

-------------------
Automatic Workflows
-------------------

To demonstrate AlphaFold2's integration into structure solution, CCP4 Cloud offers an automated project workflow: **Molecular Replacement with AlphaFold Model**. This workflow begins with data import and utilizes the `Structure Prediction <../html-taskref/doc.task.StructurePrediction.html>`_ and `MR with Model Splitting Using Slice-n-Dice <../html-taskref/doc.task.SliceNDice.html>`_ tasks to create the structure solution project automatically. Results can be refined further using individual tasks in manual mode for greater control over task parameters.

---------
Tutorials
---------

We recommend the `Creating Molecular Replacement Search Ensembles with CCP4MG/MrBUMP <../demo_project.html?cmount=Tutorials&project=T2_001.%20Creating%20Molecular%20Replacement%20Search%20Ensembles%20with%20CCP4MG.ccp4cloud>`_ tutorial to practice creating ensembles for Molecular Replacement using the `CCP4mg <https://www.ccp4.ac.uk/MG/>`_ molecular viewer.

**ACKNOWLEDGEMENTS**

This article is based on materials kindly provided by Dr. Ronan Keegan, whose assistance is greatly appreciated.
