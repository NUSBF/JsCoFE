=============================
What is *Structure Revision*?
=============================

**Structure Revision** can be viewed as a container where CCP4 Cloud stores various data items corresponding to different stages of a structure solution project. 

A minimal **Structure Revision** contains:

- A reflection dataset (HKL)
- A description of the asymmetric unit (ASU)

Typically, the minimal Structure Revision is created by the `ASU Content Definition Task <https://cloud.ccp4.ac.uk/manuals/html-taskref/doc.task.ASUDef.html>`_, which initiates the phasing stage of the structure solution.  

As the project progresses, **Structure Revision** is passed from one task to another, continuously updated with new or improved data (such as atomic coordinates, phases, or ligands) until the structure is considered solved. The final **Structure Revision** is passed to the `PDB Deposition task <https://cloud.ccp4.ac.uk/manuals/html-taskref/doc.task.Deposition.html>`_, which generates files required for deposition in the `Protein Data Bank <https://www.rcsb.org/>`_ and acquires a provisional `PDB Validation Report <https://www.wwpdb.org/validation/validation-reports/>`_.

------------------------------------------------------------------
Scope of Visibility and Project Development
------------------------------------------------------------------

As a general rule, **the Structure Revision produced by a task "shields" all revisions produced by that task's parents**. Therefore, if a particular **Structure Revision** needs to be used in more than one task, the Project *must* branch at that point, appending multiple child tasks to the task that produced the **Structure Revision**.  

The only exception to this rule is data import tasks, which do not obscure revisions visible to them.

CCP4 Cloud tasks can accept only one **Structure Revision** as input, and most produce a single **Structure Revision** as output. Therefore, in most cases, only one **Structure Revision** is available as an input choice.  

Some tasks, however, can produce multiple **Structure Revisions**, such as:

- `MAD Phasing with Crank-2 <https://cloud.ccp4.ac.uk/manuals/html-taskref/doc.task.Crank2.html>`_  
- `Experimental Phasing with Phaser-EP <https://cloud.ccp4.ac.uk/manuals/html-taskref/doc.task.Phaser.html>`_  
- `Model Building with CCP4Build <https://cloud.ccp4.ac.uk/manuals/html-taskref/doc.task.CCP4Build.html>`_  

Tasks following these will provide a choice of **Structure Revisions** as input, requiring careful user selection.

---------------------------
*Structure Revision* Naming
---------------------------

**Structure Revisions** are named following this format:  

``R0258.01: refmac (protein)/xyz,phases``  

Explanation:

- ``R`` stands for "Revision"
- ``0258`` is the serial number of the job that produced the revision
- ``01`` is the serial number of the output revision within the job
- ``refmac`` is the task name (either generic or user-defined)
- The remaining descriptors (``protein/xyz,phases``) provide additional details  

In the example above, the revision describes a crystal with protein content for 
which atomic coordinates and phases are calculated.  

- If ``xyz`` precedes ``phases``, then the phases were calculated using the coordinates (e.g., molecular replacement).  
- If not, phases were obtained through Experimental Phasing or imported into the project, and coordinates were obtained by model building.

---------------------------------------
*Structure Revision* Content Inspection
---------------------------------------

You can inspect the content of **Structure Revisions** in both input and output pages:  

- **Input Pages:** Click the **magnifying glass** button next to the Structure Revision selection widget.  
- **Output Pages:** Click the **Inspect** button next to the revision specification.

--------------------------------------------------------------------
Difference Between *Structure* and *Structure Revision*
--------------------------------------------------------------------

In CCP4 Cloud, **Structure** provides a description of the crystal structure, defined by atomic coordinates, phases, and electron density.  

On the other hand, **Structure Revision** represents the current state of the structure solution project, encompassing both experimental and generated data along a given project branch.  

**A Structure Revision includes a Structure as one of its components.**  
Effectively, a **Structure Revision** acts as a checkpoint in the structure solution project, allowing branching based on parameters or different solution approaches.