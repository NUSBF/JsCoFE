==================
Coot Task Recovery
==================

Coot Task failure may be a rather unpleasant surprise. For most other tasks in CCP4 Cloud, recovering from failure is as easy as this:

- clone task 
- start the cloned task 

and CCP4 Cloud won't even subtract CPU time, consumed by the failed task, from your quota. So, what you loose is only a bit of *your* time.

With Coot, the situation is much worse. If Coot Task fails (for example, due to unstable internet connection), you may loose hours of manual work, which may be difficult to repeat in every detail. Fortunately, Coot makes backup copies before every edit operation, and they may be used for recovery! There are three possible scenarios here.

1. **You closed Coot window without saving your data, because you simply forgot doing that.**
    In this case, CCP4 Cloud will automatically use the latest backup copy, and you will see a red warning in task's report page. What you loose in this case, is the very last edit operation, which cannot be recovered. If no editing was done, the report page will say *"No Output Structure Generated"*.

2. **You closed Coot window (having saved your work or not before that), but something went wrong (like network disconnection), and output data was not saved in CCP4 Cloud.**
    If Cloud Project continues to display your Coot Task as running:

        - make sure that your internet connection is stable (e.g., try to open https://www.bbc.co.uk in a separate tab)
        - push the *Refresh* button in the Project's vertical Toolbar: this will resume sending output data from Coot to CCP4 Cloud again. Give it some time (depending on the connection speed) 
        - if this does not work but you suspect connection problems: you may quit CCP4 Cloud till connection is re-established, and start another session later (using the "Remote" launcher). Backup copies are kept on your computer for 30 days, during which the recovery is possible.

3. **If nothing from the above helps, or is applicable to your situation, or if Cloud Project shows your Coot Task as "failed".**
    *DO NOT DELETE THE TASK* and perform manual recovery:

        - clone the task
        - start the cloned task; this should open Coot with data from the previous job, just as it was when you started the failed task 
        - in Coot's *File* menu, find item *Load CCP4 Cloud backup copy* and click on it; this will open a File Dialog showing backup directories named as "project_jobno" (e.g., "rnase_442")
        - find backup directory corresponding to the failed job, and open it. This should present you with a list of backup files with extensions ".pdb.gz" and timestamps in file names. Choose the latest backup file and click "Open"
        - now, Coot has both the original and last edited model loaded. Using Coot's *Display Manager*, delete the original model
        - save the loaded model from Coot's *File* menu and close Coot as usual -- and you're done! 

After successful recovery, the failed Coot Task may be deleted in order to regain your disk space in CCP4 Cloud and keep your Project tidy.

Happy Cooting!

:doc:`All CCP4 Cloud tips <jscofe_tips>` 
