.. _project-management:

==================
Project Management
==================

--------------------
Basic Principles
--------------------

Projects in CCP4 Cloud are designed to track the structure solution process, allowing you to review it at any time.

.. _job-tree:

In complex cases, structure solutions may require repeated actions and branching due to decision-making or parameter exploration. Therefore, **project structures in CCP4 Cloud form a tree**, rather than a simple chronological list of jobs.

*Project Trees* are built using several basic operations, accessible via the first five buttons on the vertical toolbar on the left side of the screen:

.. Note::
    All buttons are also available through a dropdown context menu, displayed by right-clicking on a job line in the *Tree*.

.. |addjob| image:: images/add.png
    :width: 18
    :height: 18   
    
|addjob| **Add a Job:**  
This adds a new job as a child to the currently selected job in the *Tree*. Pressing this button opens a task list automatically. Adding multiple jobs to the same node results in *Project Tree* branching.

.. Note::
    The context menu allows adding a job with parameters previously set in the same job type earlier in the *Project Tree*.  
    This is particularly useful during model building and refinement, where similar jobs need to run in multiple successions.

.. |clonejob| image:: images/clonejob.png
    :width: 18
    :height: 18
    
|clonejob| **Clone a Job:**  
This creates a sibling job to the currently selected one, initialized with the same data and parameters. The job dialog for the cloned job opens automatically, allowing changes before execution.

.. |delete| image:: images/delete.png
    :width: 18
    :height: 18

|delete| **Delete a Job:**  
Deletes the selected job and all jobs in its branch after confirmation.

.. Warning::
    Deleted jobs cannot be restored.

.. |stack| image:: images/job_stack.png
    :width: 18
    :height: 18

|stack| **Stack/Unstack Jobs:**  
Long project branches can be optimized by stacking jobs in linear sections (where each job has exactly one ancestor and one descendant). A typical example is a sequence of model building and refinement jobs, which can span dozens or even hundreds of jobs. Stacking collapses these jobs into a single stack for easier management.

Stacking options:

1. Select all jobs to be stacked and click the |stack| button.  

.. Note::
    The |stack| button is disabled if the selected jobs do not form a continuous linear section.

2. Select a job in a *linear section* and click the |stack| button.  
   The system will identify suitable ancestors and descendants for stacking. If both lists are non-empty, you will be prompted to choose which one (or both) to use.

.. Note::
    Automatically detected *linear sections* are constrained by branching points or existing stacks.

To unstack jobs, select the stack folder and click the |stack| button.

.. |remark| image:: images/task_remark.png
    :width: 18
    :height: 18

.. |remark_s| image:: images/task_remark_s.png
    :width: 18
    :height: 18

|remark| **Remarks:**  
Remarks provide annotations anywhere in the project. They can be sticky (with a pin icon: |remark_s|) or non-sticky. Sticky remarks remain linked to their parent jobs and are moved or deleted synchronously. Unlike other *Tree* items, remarks can be deleted without affecting descendants.

-----------------------
Managing the Jobs
-----------------------

The following toolbar buttons **do not change the Project Tree:**  

.. |openjob| image:: images/openjob.png
    :width: 18
    :height: 18
    
|openjob| **Open Job Dialog:**  
Opens the job dialog for the selected job. You can also double-click the corresponding job line in the *Project Tree*. The job dialog is used for setting input data, parameters, and executing the job.

.. |stop| image:: images/stop.png
    :width: 18
    :height: 18
    
|stop| **Stop a Job:**  
Stops the currently running job. Once stopped, jobs cannot be resumed or restarted. However, you can clone the stopped job and run the clone.

----------------------
Branch Highlighting
----------------------

.. |highlight| image:: images/highlight_branch.png
    :width: 18
    :height: 18

In complex projects, tracing specific branches can be challenging. Branch highlighting helps with this. Select a job and click the |highlight| button (or use the context menu). This highlights all ancestors of the selected job up to the project origin, as well as the descending branch leading to the most recent job.

To clear highlighting, click the |highlight| button again.

.. Note::
    To find the most recent job in a project, select the project root and click the |highlight| button.

.. _refresh-project:

--------
Refresh
--------

If the Project Page stops working due to connection errors or a hidden bug, click the |refresh| button to reload the project data and reinitialize internal functions.

.. Note::
    This action is different from the browser's Refresh button, which logs you out.

.. |refresh| image:: images/refresh.png
    :width: 16
    :height: 16

------------------------
Project Development
------------------------

You can start developing a project immediately after creating it. Most projects begin with a task from the "Data Import" section of the *Task List* at the root of the *Project Tree*. This imports available data (reflection datasets, sequences, structure homologs, ligand descriptions, etc.), which can then be used in computational jobs.

*Multiple jobs can run simultaneously, but a child job cannot use its parent's output until the parent is complete.*

CCP4 Cloud is flexible in how you grow and branch your *Project Tree*. **However, understanding CCP4 Cloud's data management principles is highly recommended to avoid common mistakes and confusion.**  
**Please read the corresponding documentation.**