============================================
Twin Refinement using REFMAC5 via CCP4 Cloud
============================================


Rob Nicholls, Garib Murshudov

In this tutorial, which consists of three parts, we consider model refinement using different parameters, twin refinement, and ligand fitting and refinement.

You can use either the local (ccp4cloud-desktop) or the remote (ccp4cloud- remote) version of CCP4 Cloud, depending on whether you want jobs to be processed on your local machine or on the CCP4 server. Note that some programs (e.g. Coot) will run on your local machine irrespective. If you use the remote version then you will need to create an account and sign in.

Part 2: Twin Refinement – Heme Oxygenase

(1) Create a new project and import the data:

Create a new CCP4 Cloud project for this part of the tutorial.

Select the Cloud Import task, navigate to "tutorial-data / 3_refinement / 2_Heme_Oxygenase" and select the provided files 1irm.pdb and 1irm.mtz. 

Close file browser.

Click the import button at the top of the window in order to run the import job

Click the green “+” button in order to add a follow-on job. Choose “Link Coordinates and Reflections” to create a structure revision.

(2) Perform model refinement twice – first using default settings, and then assuming that the data are twinned:

Add a follow-on job, and choose “Refinement with Refmac” from the task list. Provide a meaningful job description, such as: “Refine with default settings”, run the job, and close the dialog window.

Clone the refinement job. Change the “Refine using” field to “Mean Amplitudes assuming twinning”. Provide a meaningful job description, such as: “Refine assuming twinning”, and run the job. Leave this dialog window open.

(3) Inspect the results of assuming that the data correspond to a twinned crystal:

While the job is running, the results page will be updated. Summary information will be displayed in the “Report” tab. Twinning information can be found in the REFMAC5 logfile, which is displayed in the “Main Log” tab. Select the “Main Log” tab. Use your web browser’s search facility (e.g. ctrl+F, cmd+F, Edit->Find, etc.) in order to search for the word “twin” in the log file. Cycle through the results in order to find information about potential twinning in this dataset. How many potential twin domains could there be, given the space group? How many of the potential twin operators have a sufficiently low Rmerge to imply that twinning is likely? How many of the twin fractions are large enough to justify treating them as twinned for purposes of refinement? How many twin domains are assumed during refinement?

Close the job dialog window, so that you are looking at the main job tree. Both refinement jobs should have finished, and you should see the final R- factors appended to the job titles. Compare the R-factors from the two jobs. Which refinement protocol is more appropriate?

Open the results pages from the two jobs, and compare the initial R- factors. Why are they different? Is there any evidence to suggest whether or not the model was previously refined assuming twinning?

Go back to the main job tree. For each of the two jobs, add a follow-on “Model Building with Coot” job in order to display the post-refinement models and maps in Coot. You should now have two Coot windows open – one corresponding to each of the two refinement runs. Zoom in so that you can see the model and density with more clarity. Is it evident that one of the refinement runs produced a dramatically better model/map? Given the improvement in R-factors when assuming twinning, would you have expected the corresponding map to appear to be of higher quality? How much better is the model, after assuming twinning during refinement? In what way is it better?
